#!/bin/bash

echo "üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ Git –¥–ª—è Termux/Android"

# –ü—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É
PROJECT_PATH="/storage/emulated/0/TgProject"

# 1. –î–æ–±–∞–≤–∏—Ç—å –≤ safe.directory
echo "1. –î–æ–±–∞–≤–ª—è—é $PROJECT_PATH –≤ safe.directory..."
git config --global --add safe.directory "$PROJECT_PATH"

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
echo "2. –ü—Ä–æ–≤–µ—Ä—è—é –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ safe.directory:"
git config --global --get-all safe.directory

# 3. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ)
echo "3. –ò—Å–ø—Ä–∞–≤–ª—è—é –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º..."
chmod 755 "$PROJECT_PATH" 2>/dev/null || echo "–ù–µ —É–¥–∞–ª–æ—Å—å –∏–∑–º–µ–Ω–∏—Ç—å –ø—Ä–∞–≤–∞, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º..."

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
echo "4. –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: $(whoami)"
echo "   ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: $(id -u)"
echo "   ID –≥—Ä—É–ø–ø—ã: $(id -g)"

# 5. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å --safe-directory –ø—Ä–∏ –≤—ã–∑–æ–≤–µ git
echo "5. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç:"
echo "   –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: git -c safe.directory='$PROJECT_PATH' [–∫–æ–º–∞–Ω–¥–∞]"

# 6. –°–æ–∑–¥–∞—Ç—å –∞–ª–∏–∞—Å –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
echo "6. –°–æ–∑–¥–∞—é –∞–ª–∏–∞—Å git='git -c safe.directory=\"$PROJECT_PATH\"'"
alias git="git -c safe.directory='$PROJECT_PATH'"

echo "‚úÖ –ì–æ—Ç–æ–≤–æ! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å git status"